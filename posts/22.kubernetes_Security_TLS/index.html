<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="[kubernetes-실습] Security - TLS" /><meta property="og:locale" content="en" /><meta name="description" content="kubernetes 인증 시험(CKA)에 대비하기 위해 실습을 해보도록 한다." /><meta property="og:description" content="kubernetes 인증 시험(CKA)에 대비하기 위해 실습을 해보도록 한다." /><link rel="canonical" href="https://ps2046.github.io/posts/22.kubernetes_Security_TLS/" /><meta property="og:url" content="https://ps2046.github.io/posts/22.kubernetes_Security_TLS/" /><meta property="og:site_name" content="ps’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-26T13:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[kubernetes-실습] Security - TLS" /><meta name="twitter:site" content="@ps2046" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"kubernetes 인증 시험(CKA)에 대비하기 위해 실습을 해보도록 한다.","headline":"[kubernetes-실습] Security - TLS","dateModified":"2021-08-26T00:00:00+09:00","url":"https://ps2046.github.io/posts/22.kubernetes_Security_TLS/","datePublished":"2021-01-26T13:00:00+09:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ps2046.github.io/posts/22.kubernetes_Security_TLS/"},"@context":"https://schema.org"}</script><title>[kubernetes-실습] Security - TLS | ps's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ps's Blog"><meta name="application-name" content="ps's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7635228999568716" crossorigin="anonymous"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/11029548?s=400&u=5ebc191faa53e931968ec2ed98bd7c7b68136c71&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ps's Blog</a></div><div class="site-subtitle font-italic">System Engineer & Developer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/ps2046" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/ps2046" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ps2046.jang','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[kubernetes-실습] Security - TLS</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[kubernetes-실습] Security - TLS</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> ps.jang </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 26, 2021, 1:00 PM +0900" >Jan 26<i class="unloaded">2021-01-26T13:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Aug 26, 2021, 12:00 AM +0000" >Aug 26<i class="unloaded">2021-08-26T00:00:00+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2389 words">13 min read</span></div></div><div class="post-content"><h2 id="working-with-tls">Working with TLS</h2><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c"># 마스터 노드와 보조 노드 모두에서 kubelet 을 보자 . </span>
<span class="c"># kube-apiserver 는 cerificates 과 authorization mode와 같은 보안 정보를 보여준다. </span>
<span class="c"># kubelet 은 systemd 서비스이므로 아래와 같이 상태를 볼수 있다.</span>
<span class="c"># 아래 CGroup 정보에 보면 설정 파일들이 어디에 있는지 알수 있다.</span>
ps0107@k8smaster1:~<span class="nv">$ </span>systemctl status kubelet.service
● kubelet.service - kubelet: The Kubernetes Node Agent
   Loaded: loaded <span class="o">(</span>/lib/systemd/system/kubelet.service<span class="p">;</span> enabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
  Drop-In: /etc/systemd/system/kubelet.service.d
           └─10-kubeadm.conf
   Active: active <span class="o">(</span>running<span class="o">)</span> since Tue 2020-01-28 08:29:18 UTC<span class="p">;</span> 2 weeks 1 days ago
     Docs: https://kubernetes.io/docs/home/
 Main PID: 5279 <span class="o">(</span>kubelet<span class="o">)</span>
    Tasks: 23
   Memory: 54.6M
      CPU: 10h 30min 49.915s
   CGroup: /system.slice/kubelet.service
           └─5279 /usr/bin/kubelet <span class="nt">--bootstrap-kubeconfig</span><span class="o">=</span>/etc/kubernetes/bootstrap-kubelet.conf <span class="nt">--kubeconfig</span><span class="o">=</span>/etc/kubernetes/kubelet.conf <span class="nt">--config</span><span class="o">=</span>/var/lib/kubelet/config.yaml <span class="nt">--cgroup-driver</span><span class="o">=</span>cgroupfs <span class="nt">--network-plugin</span><span class="o">=</span>cni <span class="nt">--pod-infra</span> ....
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre><td class="rouge-code"><pre><span class="c"># /var/lib/kubelet/config.yaml 안의 세팅을 보자.</span>
<span class="c"># 살펴보면 kube-apiserver를 접근하기 위해 /etc/kubernetes/pki/ 디렉토리를 볼 수 있다.</span>
<span class="c"># 끝부분을 좀더 보면 다른 pod spec 파일들을 찾을 수 있도록 디렉토리가 세팅되어 있다.</span>
ps0107@k8smaster1:~<span class="nv">$ </span><span class="nb">sudo cat</span> /var/lib/kubelet/config.yaml
address: 0.0.0.0
apiVersion: kubelet.config.k8s.io/v1beta1
authentication:
  anonymous:
    enabled: <span class="nb">false
  </span>webhook:
    cacheTTL: 2m0s
    enabled: <span class="nb">true
  </span>x509:
    clientCAFile: /etc/kubernetes/pki/ca.crt
authorization:
  mode: Webhook
  webhook:
    cacheAuthorizedTTL: 5m0s
    cacheUnauthorizedTTL: 30s
cgroupDriver: cgroupfs
cgroupsPerQOS: <span class="nb">true
</span>clusterDNS:
- 10.96.0.10
clusterDomain: cluster.local
configMapAndSecretChangeDetectionStrategy: Watch
containerLogMaxFiles: 5
containerLogMaxSize: 10Mi
contentType: application/vnd.kubernetes.protobuf
cpuCFSQuota: <span class="nb">true
</span>cpuCFSQuotaPeriod: 100ms
cpuManagerPolicy: none
cpuManagerReconcilePeriod: 10s
enableControllerAttachDetach: <span class="nb">true
</span>enableDebuggingHandlers: <span class="nb">true
</span>enforceNodeAllocatable:
- pods
eventBurst: 10
eventRecordQPS: 5
evictionHard:
  imagefs.available: 15%
  memory.available: 100Mi
  nodefs.available: 10%
  nodefs.inodesFree: 5%
evictionPressureTransitionPeriod: 5m0s
failSwapOn: <span class="nb">true
</span>fileCheckFrequency: 20s
hairpinMode: promiscuous-bridge
healthzBindAddress: 127.0.0.1
healthzPort: 10248
httpCheckFrequency: 20s
imageGCHighThresholdPercent: 85
imageGCLowThresholdPercent: 80
imageMinimumGCAge: 2m0s
iptablesDropBit: 15
iptablesMasqueradeBit: 14
kind: KubeletConfiguration
kubeAPIBurst: 10
kubeAPIQPS: 5
makeIPTablesUtilChains: <span class="nb">true
</span>maxOpenFiles: 1000000
maxPods: 110
nodeLeaseDurationSeconds: 40
nodeStatusReportFrequency: 1m0s
nodeStatusUpdateFrequency: 10s
oomScoreAdj: <span class="nt">-999</span>
podPidsLimit: <span class="nt">-1</span>
port: 10250
registryBurst: 10
registryPullQPS: 5
resolvConf: /etc/resolv.conf
rotateCertificates: <span class="nb">true
</span>runtimeRequestTimeout: 2m0s
serializeImagePulls: <span class="nb">true
</span>staticPodPath: /etc/kubernetes/manifests
streamingConnectionIdleTimeout: 4h0m0s
syncFrequency: 1m0s
volumeStatsAggPeriod: 1m0s
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
</pre><td class="rouge-code"><pre><span class="c"># 마스터 노드의 다른 에이전트들은 kube-apiserver와 상호작용하고 있다.</span>
<span class="c"># 이러한 세팅을 하기 위해 만들어진 설정 파일들을 보자.</span>
<span class="c"># yaml file들이 있고 file안에 cert 정보도 있다.</span>
ps0107@k8smaster1:~<span class="nv">$ </span><span class="nb">sudo ls</span> /etc/kubernetes/manifests/
etcd.yaml  kube-apiserver.yaml	kube-controller-manager.yaml  kube-scheduler.yaml

ps0107@k8smaster1:~<span class="nv">$ </span><span class="nb">sudo cat</span> /etc/kubernetes/manifests/kube-controller-manager.yaml
apiVersion: v1
kind: Pod
metadata:
  creationTimestamp: null
  labels:
    component: kube-controller-manager
    tier: control-plane
  name: kube-controller-manager
  namespace: kube-system
spec:
  containers:
  - <span class="nb">command</span>:
    - kube-controller-manager
    - <span class="nt">--allocate-node-cidrs</span><span class="o">=</span><span class="nb">true</span>
    - <span class="nt">--authentication-kubeconfig</span><span class="o">=</span>/etc/kubernetes/controller-manager.conf
    - <span class="nt">--authorization-kubeconfig</span><span class="o">=</span>/etc/kubernetes/controller-manager.conf
    - <span class="nt">--bind-address</span><span class="o">=</span>127.0.0.1
    - <span class="nt">--client-ca-file</span><span class="o">=</span>/etc/kubernetes/pki/ca.crt
    - <span class="nt">--cluster-cidr</span><span class="o">=</span>192.168.0.0/16
    - <span class="nt">--cluster-signing-cert-file</span><span class="o">=</span>/etc/kubernetes/pki/ca.crt
    - <span class="nt">--cluster-signing-key-file</span><span class="o">=</span>/etc/kubernetes/pki/ca.key
    - <span class="nt">--controllers</span><span class="o">=</span><span class="k">*</span>,bootstrapsigner,tokencleaner
    - <span class="nt">--kubeconfig</span><span class="o">=</span>/etc/kubernetes/controller-manager.conf
    - <span class="nt">--leader-elect</span><span class="o">=</span><span class="nb">true</span>
    - <span class="nt">--node-cidr-mask-size</span><span class="o">=</span>24
    - <span class="nt">--requestheader-client-ca-file</span><span class="o">=</span>/etc/kubernetes/pki/front-proxy-ca.crt
    - <span class="nt">--root-ca-file</span><span class="o">=</span>/etc/kubernetes/pki/ca.crt
    - <span class="nt">--service-account-private-key-file</span><span class="o">=</span>/etc/kubernetes/pki/sa.key
    - <span class="nt">--use-service-account-credentials</span><span class="o">=</span><span class="nb">true
    </span>image: k8s.gcr.io/kube-controller-manager:v1.15.1
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /healthz
        port: 10252
        scheme: HTTP
      initialDelaySeconds: 15
      timeoutSeconds: 15
    name: kube-controller-manager
    resources:
      requests:
        cpu: 200m
    volumeMounts:
    - mountPath: /etc/ssl/certs
      name: ca-certs
      readOnly: <span class="nb">true</span>
    - mountPath: /etc/ca-certificates
      name: etc-ca-certificates
      readOnly: <span class="nb">true</span>
    - mountPath: /usr/libexec/kubernetes/kubelet-plugins/volume/exec
      name: flexvolume-dir
    - mountPath: /etc/kubernetes/pki
      name: k8s-certs
      readOnly: <span class="nb">true</span>
    - mountPath: /etc/kubernetes/controller-manager.conf
      name: kubeconfig
      readOnly: <span class="nb">true</span>
    - mountPath: /usr/local/share/ca-certificates
      name: usr-local-share-ca-certificates
      readOnly: <span class="nb">true</span>
    - mountPath: /usr/share/ca-certificates
      name: usr-share-ca-certificates
      readOnly: <span class="nb">true
  </span>hostNetwork: <span class="nb">true
  </span>priorityClassName: system-cluster-critical
  volumes:
  - hostPath:
      path: /etc/ssl/certs
      <span class="nb">type</span>: DirectoryOrCreate
    name: ca-certs
  - hostPath:
      path: /etc/ca-certificates
      <span class="nb">type</span>: DirectoryOrCreate
    name: etc-ca-certificates
  - hostPath:
      path: /usr/libexec/kubernetes/kubelet-plugins/volume/exec
      <span class="nb">type</span>: DirectoryOrCreate
    name: flexvolume-dir
  - hostPath:
      path: /etc/kubernetes/pki
      <span class="nb">type</span>: DirectoryOrCreate
    name: k8s-certs
  - hostPath:
      path: /etc/kubernetes/controller-manager.conf
      <span class="nb">type</span>: FileOrCreate
    name: kubeconfig
  - hostPath:
      path: /usr/local/share/ca-certificates
      <span class="nb">type</span>: DirectoryOrCreate
    name: usr-local-share-ca-certificates
  - hostPath:
      path: /usr/share/ca-certificates
      <span class="nb">type</span>: DirectoryOrCreate
    name: usr-share-ca-certificates
status: <span class="o">{}</span>
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="c"># 토큰 사용은 구성요소 통신을 승인하는 데 중심이 된다. 토큰은 secrets 로 가진다.</span>
<span class="c"># kube-system namespace의 secrets를 확인해 보자.</span>
ps0107@k8smaster1:~<span class="nv">$ </span>kubectl <span class="nt">-n</span> kube-system get secrets
NAME                                             TYPE                                  DATA   AGE
attachdetach-controller-token-q6gnc              kubernetes.io/service-account-token   3      15d
bootstrap-signer-token-52n72                     kubernetes.io/service-account-token   3      15d
bootstrap-token-jaeaqt                           bootstrap.kubernetes.io/token         6      15d
bootstrap-token-qa1m8y                           bootstrap.kubernetes.io/token         4      15d
calico-node-token-9d74h                          kubernetes.io/service-account-token   3      15d
certificate-controller-token-scw76               kubernetes.io/service-account-token   3      15d
clusterrole-aggregation-controller-token-bzb8m   kubernetes.io/service-account-token   3      15d
coredns-token-cmpj6                              kubernetes.io/service-account-token   3      15d
cronjob-controller-token-rdp76                   kubernetes.io/service-account-token   3      15d
daemon-set-controller-token-zrfl2                kubernetes.io/service-account-token   3      15d
default-token-9xjr8                              kubernetes.io/service-account-token   3      15d
deployment-controller-token-dghwg                kubernetes.io/service-account-token   3      15d
disruption-controller-token-s5rdz                kubernetes.io/service-account-token   3      15d
endpoint-controller-token-fk4gw                  kubernetes.io/service-account-token   3      15d
expand-controller-token-xqdz5                    kubernetes.io/service-account-token   3      15d
generic-garbage-collector-token-gg8l7            kubernetes.io/service-account-token   3      15d
horizontal-pod-autoscaler-token-5xjpz            kubernetes.io/service-account-token   3      15d
job-controller-token-ndn45                       kubernetes.io/service-account-token   3      15d
kube-proxy-token-7jjl9                           kubernetes.io/service-account-token   3      15d
kubeadm-certs                                    Opaque                                8      15d
metrics-server-token-6rpkb                       kubernetes.io/service-account-token   3      7d13h
namespace-controller-token-z7vnn                 kubernetes.io/service-account-token   3      15d
node-controller-token-jgg7f                      kubernetes.io/service-account-token   3      15d
persistent-volume-binder-token-7qksk             kubernetes.io/service-account-token   3      15d
pod-garbage-collector-token-9bgvk                kubernetes.io/service-account-token   3      15d
pv-protection-controller-token-7nbqk             kubernetes.io/service-account-token   3      15d
pvc-protection-controller-token-zssxk            kubernetes.io/service-account-token   3      15d
replicaset-controller-token-59szg                kubernetes.io/service-account-token   3      15d
replication-controller-token-5j78s               kubernetes.io/service-account-token   3      15d
resourcequota-controller-token-95qgb             kubernetes.io/service-account-token   3      15d
service-account-controller-token-d4fmk           kubernetes.io/service-account-token   3      15d
service-controller-token-wbbpt                   kubernetes.io/service-account-token   3      15d
statefulset-controller-token-hsk8b               kubernetes.io/service-account-token   3      15d
tiller-token-6vv6j                               kubernetes.io/service-account-token   3      4d5h
token-cleaner-token-v8r9r                        kubernetes.io/service-account-token   3      15d
traefik-ingress-controller-token-8h7rs           kubernetes.io/service-account-token   3      8d
ttl-controller-token-tjbl4                       kubernetes.io/service-account-token   3      15d
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="c"># secrets 중에 하나를 살펴보자. </span>
ps0107@k8smaster1:~<span class="nv">$ </span>kubectl <span class="nt">-n</span> kube-system get secrets certificate-controller-token-scw76 <span class="nt">-o</span> yaml
apiVersion: v1
data:
  ca.crt: <span class="nv">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUN5RENDQWJDZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJd01ERXlPREE0TWprd09Wb1hEVE13TURFeU5UQTRNamt3T1Zvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTk9XCjZMdDkweTMvZDU2VEdIZFFWR25hZGtScXhPUERPYmplOVpUTkVIU3JWZUU3NWpPQ1A0RWdaTFVxcjBBWm5mSTIKQ0hSU3ZGdkdUT2Qza0o0bnRMS0RrT21VaWV4N2s0ZnRJM0lNc0RraDM4OTMzaGxMRDBBTzZzR3cvUnZpaVJ2Swo1N0RLVjRBaXFTTkRabXlpRFJHRFAvc3o1NllzTEdhQXJTUzVwcFYrQ2NKanhHeXV2UXNKZmZEekJsZ2FCakRoCmlWcDhrdTBNVUpFRktLbDNTNnhLZXRZRTRwZVpNcmlGZUpBb0pVZTZscmpYRWplVVN1a29FdmxmbGJIMGhWL3IKWk1ydkwwaGRKeWdIQjVnZWJnVHVCWDhIWkR4dDBFT1M5ZnBYNWxjYXRJR1g5NGVQdW9PcENYWDF1RVg4alpwYQpzZkpHSkRzdS9pTi9vMWZYcXU4Q0F3RUFBYU1qTUNFd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dFQkFDa01VR0pPM2xycEppL2RKdmhZSkdwK29sMHQKQ3lUSVhrK2oyMDFhbmZKYkFiVllENStvb2FxUnRzNWFaa01RZ2loWjUyNGw2bGZ6N3NUNEE0M3VZL3lITmllRgpwb2RvdFFMWXlyRmRCcUoyaFhpcVFOQjRjNHloUXFkMG0rSTNwazJIMDNTOG85MWZ1VUJ3NWZSbDUxRUtIT3I1Ci84cldqdW55KzBRY1IvaEVLZlA5alV0NVZsbm4zMVJPMkhVeFUyTmlQTCtJK0dtWCtod3hzRFkyUk9TZ2xuWUsKcjNkaGU2RXpHQTZBcTJqMmtENTJteWFmNXNRY0NjeXg1cDlSNGdXcWxFTFU1VFZONldTWnVCT3AxQld6azI3NgpURFFRL0hVeHBGSTdZSEtTeVkza0xCb2JoSzViM0syS1RqQk45aEduMisxaHNETFM1R1ZRbkVQMlVTUT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo</span><span class="o">=</span>
  namespace: <span class="nv">a3ViZS1zeXN0ZW0</span><span class="o">=</span>
  token: ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNklpSjkuZXlKcGMzTWlPaUpyZFdKbGNtNWxkR1Z6TDNObGNuWnBZMlZoWTJOdmRXNTBJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5dVlXMWxjM0JoWTJVaU9pSnJkV0psTFhONWMzUmxiU0lzSW10MVltVnlibVYwWlhNdWFXOHZjMlZ5ZG1salpXRmpZMjkxYm5RdmMyVmpjbVYwTG01aGJXVWlPaUpqWlhKMGFXWnBZMkYwWlMxamIyNTBjbTlzYkdWeUxYUnZhMlZ1TFhOamR6YzJJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpYSjJhV05sTFdGalkyOTFiblF1Ym1GdFpTSTZJbU5sY25ScFptbGpZWFJsTFdOdmJuUnliMnhzWlhJaUxDSnJkV0psY201bGRHVnpMbWx2TDNObGNuWnBZMlZoWTJOdmRXNTBMM05sY25acFkyVXRZV05qYjNWdWRDNTFhV1FpT2lKall6RTVZVEV5TkMweU5HVmhMVFF4TTJVdFlURmlNUzAxWVRJd016VTBaR05oTVRJaUxDSnpkV0lpT2lKemVYTjBaVzA2YzJWeWRtbGpaV0ZqWTI5MWJuUTZhM1ZpWlMxemVYTjBaVzA2WTJWeWRHbG1hV05oZEdVdFkyOXVkSEp2Ykd4bGNpSjkuQnJJbnVnLVdLVV9QVlZPYzd4X2w4THB2QnpiUkFzVjdUVDFiZDg1S1hTRkUyN2JhNGVQdE83VldNQnlsSXlPTzN6bUpvWERaWk5pRWhYeERpNVpBRUJEVnRYRkx4YTNDYWtxWDJ5cmtqUnNBUEFjejZYQ3RBMDBmZFBBTHNqTjBXUXdibVJTUWZlYUMyZGpXWnJubVBQOXhpQVBlRzEtVHdpeFVmUVN5Q2kwb1pjdGd6MV9Cd0FRcWVtQ2pYUDlsOFpFRW5SbmNYWkE2VExWcUpmWDhwOC1zTkVBYUUtZlV5LW5uRDkxVmRrTlpJbW5sUURrSmZsNkJUcTBDMDFOV2doNkcyYlVkMzhLZlBuZzJsSl9PclBXQTRKUThzN3JoRTdVR2RMZlE0RkFMWWNIUll2SUVsUHNYdDNHeGJBS0xoWER3aDluLUlHOE40eTNIZzRQdlp3
kind: Secret
metadata:
  annotations:
    kubernetes.io/service-account.name: certificate-controller
    kubernetes.io/service-account.uid: cc19a124-24ea-413e-a1b1-5a20354dca12
  creationTimestamp: <span class="s2">"2020-01-28T08:29:34Z"</span>
  name: certificate-controller-token-scw76
  namespace: kube-system
  resourceVersion: <span class="s2">"230"</span>
  selfLink: /api/v1/namespaces/kube-system/secrets/certificate-controller-token-scw76
  uid: c64afb36-0f19-4ccd-877c-fb36f660f07a
<span class="nb">type</span>: kubernetes.io/service-account-token
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c"># kubectl config 명령은 view, update 파라메터를 사용할 수 있다.</span>
<span class="c"># 업데이트할 때 오타가 클러스터에 대한 액세스를 제거하지 않을 수도 있다. </span>
<span class="c"># 현재 구성 설정을 보자. 출력에서 키와 인증서들이 자동으로 수정된다.</span>
ps0107@k8smaster1:~<span class="nv">$ </span>kubectl config view
apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: DATA+OMITTED
    server: https://k8smaster:6443
  name: kubernetes
contexts:
- context:
    cluster: kubernetes
    user: kubernetes-admin
  name: kubernetes-admin@kubernetes
current-context: kubernetes-admin@kubernetes
kind: Config
preferences: <span class="o">{}</span>
<span class="nb">users</span>:
- name: kubernetes-admin
  user:
    client-certificate-data: REDACTED. <span class="c"># &lt;- 이부분 확인 (redacted : 수정된)</span>
    client-key-data: REDACTED <span class="c"># &lt;- 이부분 확인</span>
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c"># 키 대신 admin의 암호 설정과 같은 옵션들을 보자.</span>
ps0107@k8smaster1:~<span class="nv">$ </span>kubectl config set-credentials <span class="nt">-h</span>
Sets a user entry <span class="k">in </span>kubeconfig

 Specifying a name that already exists will merge new fields on top of existing values.

  Client-certificate flags:
  <span class="nt">--client-certificate</span><span class="o">=</span>certfile <span class="nt">--client-key</span><span class="o">=</span>keyfile

  Bearer token flags:
    <span class="nt">--token</span><span class="o">=</span>bearer_token

  Basic auth flags:
    <span class="nt">--username</span><span class="o">=</span>basic_user <span class="nt">--password</span><span class="o">=</span>basic_password

 Bearer token and basic auth are mutually exclusive.

Examples:
  <span class="c"># Set only the "client-key" field on the "cluster-admin"</span>
  <span class="c"># entry, without touching other values:</span>
  kubectl config set-credentials cluster-admin <span class="nt">--client-key</span><span class="o">=</span>~/.kube/admin.key
.....
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
</pre><td class="rouge-code"><pre><span class="c"># 이제 access configuration file을 변경하면서 다른 점들을 살펴보자.</span>
<span class="c"># 미리 이전 파일을 백업 받아 둔다.</span>
ps0107@k8smaster1:~<span class="nv">$ </span><span class="nb">cp</span> ~/.kube/config ~/cluster-api-config

<span class="c"># kubectl틀과 kubeadm을 모두 사용하여 클러스터 및 보안 구성으로 작업할 수 있도록 탐색해보자. </span>
<span class="c"># 다른 값 중에서 클러스터의 이름을 찾는다. kubeadm을 사용하기 위해서는 root로 되어야 한다.</span>
ps0107@k8smaster1:~<span class="nv">$ </span>kubectl config &lt;tab x 2&gt;
current-context  delete-context   get-contexts     <span class="nb">set              </span>set-context      <span class="nb">unset            </span>view
delete-cluster   get-clusters     rename-context   set-cluster      set-credentials  use-context

ps0107@k8smaster1:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-i</span>
root@k8smaster1:~# kubeadm token <span class="nt">-h</span>

This <span class="nb">command </span>manages bootstrap tokens. It is optional and needed only <span class="k">for </span>advanced use cases.

In short, bootstrap tokens are used <span class="k">for </span>establishing bidirectional trust between a client and a server.
A bootstrap token can be used when a client <span class="o">(</span><span class="k">for </span>example a node that is about to <span class="nb">join </span>the cluster<span class="o">)</span> needs
to trust the server it is talking to. Then a bootstrap token with the <span class="s2">"signing"</span> usage can be used.
bootstrap tokens can also <span class="k">function </span>as a way to allow short-lived authentication to the API Server
<span class="o">(</span>the token serves as a way <span class="k">for </span>the API Server to trust the client<span class="o">)</span>, <span class="k">for </span>example <span class="k">for </span>doing the TLS Bootstrap.

What is a bootstrap token more exactly?
 - It is a Secret <span class="k">in </span>the kube-system namespace of <span class="nb">type</span> <span class="s2">"bootstrap.kubernetes.io/token"</span><span class="nb">.</span>
 - A bootstrap token must be of the form <span class="s2">"[a-z0-9]{6}.[a-z0-9]{16}"</span><span class="nb">.</span> The former part is the public token ID,
   <span class="k">while </span>the latter is the Token Secret and it must be kept private at all circumstances!
 - The name of the Secret must be named <span class="s2">"bootstrap-token-(token-id)"</span><span class="nb">.</span>

You can <span class="nb">read </span>more about bootstrap tokens here:
  https://kubernetes.io/docs/admin/bootstrap-tokens/

Usage:
  kubeadm token <span class="o">[</span>flags]
  kubeadm token <span class="o">[</span><span class="nb">command</span><span class="o">]</span>

Available Commands:
  create      Create bootstrap tokens on the server
  delete      Delete bootstrap tokens on the server
  generate    Generate and print a bootstrap token, but <span class="k">do </span>not create it on the server
  list        List bootstrap tokens on the server

Flags:
      <span class="nt">--dry-run</span>             Whether to <span class="nb">enable </span>dry-run mode or not
  <span class="nt">-h</span>, <span class="nt">--help</span>                <span class="nb">help </span><span class="k">for </span>token
      <span class="nt">--kubeconfig</span> string   The kubeconfig file to use when talking to the cluster. If the flag is not <span class="nb">set</span>, a <span class="nb">set </span>of standard locations can be searched <span class="k">for </span>an existing kubeconfig file. <span class="o">(</span>default <span class="s2">"/etc/kubernetes/admin.conf"</span><span class="o">)</span>

Global Flags:
      <span class="nt">--log-file</span> string          If non-empty, use this log file
      <span class="nt">--log-file-max-size</span> uint   Defines the maximum size a log file can grow to. Unit is megabytes. If the value is 0, the maximum file size is unlimited. <span class="o">(</span>default 1800<span class="o">)</span>
      <span class="nt">--rootfs</span> string            <span class="o">[</span>EXPERIMENTAL] The path to the <span class="s1">'real'</span> host root filesystem.
      <span class="nt">--skip-headers</span>             If <span class="nb">true</span>, avoid header prefixes <span class="k">in </span>the log messages
      <span class="nt">--skip-log-headers</span>         If <span class="nb">true</span>, avoid headers when opening log files
  <span class="nt">-v</span>, <span class="nt">--v</span> Level                  number <span class="k">for </span>the log level verbosity

Use <span class="s2">"kubeadm token [command] --help"</span> <span class="k">for </span>more information about a command.


root@k8smaster1:~# kubeadm config <span class="nt">-h</span>

There is a ConfigMap <span class="k">in </span>the kube-system namespace called <span class="s2">"kubeadm-config"</span> that kubeadm uses to store internal configuration about the
cluster. kubeadm CLI v1.8.0+ automatically creates this ConfigMap with the config used with <span class="s1">'kubeadm init'</span>, but <span class="k">if </span>you
initialized your cluster using kubeadm v1.7.x or lower, you must use the <span class="s1">'config upload'</span> <span class="nb">command </span>to create this
ConfigMap. This is required so that <span class="s1">'kubeadm upgrade'</span> can configure your upgraded cluster correctly.

Usage:
  kubeadm config <span class="o">[</span>flags]
  kubeadm config <span class="o">[</span><span class="nb">command</span><span class="o">]</span>

Available Commands:
  images      Interact with container images used by kubeadm
  migrate     Read an older version of the kubeadm configuration API types from a file, and output the similar config object <span class="k">for </span>the newer version
  print       Print configuration
  view        View the kubeadm configuration stored inside the cluster

Flags:
  <span class="nt">-h</span>, <span class="nt">--help</span>                <span class="nb">help </span><span class="k">for </span>config
      <span class="nt">--kubeconfig</span> string   The kubeconfig file to use when talking to the cluster. If the flag is not <span class="nb">set</span>, a <span class="nb">set </span>of standard locations can be searched <span class="k">for </span>an existing kubeconfig file. <span class="o">(</span>default <span class="s2">"/etc/kubernetes/admin.conf"</span><span class="o">)</span>

Global Flags:
      <span class="nt">--log-file</span> string          If non-empty, use this log file
      <span class="nt">--log-file-max-size</span> uint   Defines the maximum size a log file can grow to. Unit is megabytes. If the value is 0, the maximum file size is unlimited. <span class="o">(</span>default 1800<span class="o">)</span>
      <span class="nt">--rootfs</span> string            <span class="o">[</span>EXPERIMENTAL] The path to the <span class="s1">'real'</span> host root filesystem.
      <span class="nt">--skip-headers</span>             If <span class="nb">true</span>, avoid header prefixes <span class="k">in </span>the log messages
      <span class="nt">--skip-log-headers</span>         If <span class="nb">true</span>, avoid headers when opening log files
  <span class="nt">-v</span>, <span class="nt">--v</span> Level                  number <span class="k">for </span>the log level verbosity

Use <span class="s2">"kubeadm config [command] --help"</span> <span class="k">for </span>more information about a command.
</pre></table></code></div></div><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="c"># 클러스터의 기본 설정 세티등을 보자.</span>
ps0107@k8smaster1:~<span class="nv">$ </span><span class="nb">sudo </span>kubeadm config print init-defaults
apiVersion: kubeadm.k8s.io/v1beta2
bootstrapTokens:
- <span class="nb">groups</span>:
  - system:bootstrappers:kubeadm:default-node-token
  token: abcdef.0123456789abcdef
  ttl: 24h0m0s
  usages:
  - signing
  - authentication
kind: InitConfiguration
localAPIEndpoint:
  advertiseAddress: 1.2.3.4
  bindPort: 6443
nodeRegistration:
  criSocket: /var/run/dockershim.sock
  name: k8smaster1
  taints:
  - effect: NoSchedule
    key: node-role.kubernetes.io/master
<span class="nt">---</span>
apiServer:
  timeoutForControlPlane: 4m0s
apiVersion: kubeadm.k8s.io/v1beta2
certificatesDir: /etc/kubernetes/pki
clusterName: kubernetes
controllerManager: <span class="o">{}</span>
dns:
  <span class="nb">type</span>: CoreDNS
etcd:
  <span class="nb">local</span>:
    dataDir: /var/lib/etcd
imageRepository: k8s.gcr.io
kind: ClusterConfiguration
kubernetesVersion: v1.14.0
networking:
  dnsDomain: cluster.local
  serviceSubnet: 10.96.0.0/12
scheduler: <span class="o">{}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/kubernetes/'>Kubernetes</a>, <a href='/categories/kubernetes-administration-course/'>Kubernetes Administration Course</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/cka/" class="post-tag no-text-decoration" >cka</a> <a href="/tags/lfs458/" class="post-tag no-text-decoration" >LFS458</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[kubernetes-실습] Security - TLS - ps's Blog&url=https://ps2046.github.io/posts/22.kubernetes_Security_TLS/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[kubernetes-실습] Security - TLS - ps's Blog&u=https://ps2046.github.io/posts/22.kubernetes_Security_TLS/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[kubernetes-실습] Security - TLS - ps's Blog&url=https://ps2046.github.io/posts/22.kubernetes_Security_TLS/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/blog-comments-utterances/">[blog] github blog comments (utterances)</a><li><a href="/posts/17.kubernetes_Scheduling_2/">[kubernetes-실습] Scheduling - Taint를 이용한 pod 배포 관리</a><li><a href="/posts/18.kubernetes_logging_trubleshooting_1/">[kubernetes-실습] 로깅과 트러블슈팅 : 로그위치와 로그 출력 보기</a><li><a href="/posts/19.kubernetes_logging_trubleshooting_2/">[kubernetes-실습] 로깅과 트러블슈팅 : Metrics와 DashBoard</a><li><a href="/posts/20.kubernetes_crd/">[kubernetes-실습] CRD (Custom Resource Definition)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cka/">cka</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/lfs458/">LFS458</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/comments/">comments</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/monitoring/">monitoring</a> <a class="post-tag" href="/tags/system/">system</a> <a class="post-tag" href="/tags/utterances/">utterances</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/17.kubernetes_Scheduling_2/"><div class="card-body"> <span class="timeago small" >Jan 26<i class="unloaded">2021-01-26T08:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[kubernetes-실습] Scheduling - Taint를 이용한 pod 배포 관리</h3><div class="text-muted small"><p> Using Taints to Control Pod Deployment taints를 사용하여 어느곳에 pod가 배치되거나 실행을 허용하도록 관리할수 있다. 노드 그룹에 pod들을 할당하여 추가할때 노드 사용을 제한하거나 pod들을 완전히 대피시킬수 있다. 참고 마스터노드가 처음에 NoSchedule taint로 설정되어 있었던것을 기억할 것이다...</p></div></div></a></div><div class="card"> <a href="/posts/18.kubernetes_logging_trubleshooting_1/"><div class="card-body"> <span class="timeago small" >Jan 26<i class="unloaded">2021-01-26T09:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[kubernetes-실습] 로깅과 트러블슈팅 : 로그위치와 로그 출력 보기</h3><div class="text-muted small"><p> 로그 파일들의 위치 알아보기 다양한 로그 파일과 명령 출력 이외에도 journalctl을 사용하여 노드 관점에서 로그를 볼 수 있다. 우리는 로그 파일의 공통적인 위치를 보고, 컨테이너 로그를 보는 명령을 볼 것이다. 다른 컨테이너의 로그를 pod에 적재하는데 전용으로 사용되는 sidecar container의 사용과 같은 다른 로깅 ...</p></div></div></a></div><div class="card"> <a href="/posts/19.kubernetes_logging_trubleshooting_2/"><div class="card-body"> <span class="timeago small" >Jan 26<i class="unloaded">2021-01-26T10:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[kubernetes-실습] 로깅과 트러블슈팅 : Metrics와 DashBoard</h3><div class="text-muted small"><p> Metrics 설정 heapster가 deprecation 되면서 Metrics Server 와 통합되어 개발되고 배포되어지고 있다. 그리고 CNCF의 프로젝트중 프로메테우스도 잘 사용되어지고 있다. # --------------------------------- # Metrics 설정 # ----------------------------...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/21.kubernetes_helm/" class="btn btn-outline-primary" prompt="Older"><p>[kubernetes-실습] helm</p></a> <a href="/posts/23.kubernetes_Security_Authentication_Authorization_Admission/" class="btn btn-outline-primary" prompt="Newer"><p>[kubernetes-실습] Security - Authentication, Authorization, Admission</p></a></div><script src="https://utteranc.es/client.js" repo="ps2046/ps2046-github-io-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://ps2046.github.io">ps.jang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/cka/">cka</a> <a class="post-tag" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag" href="/tags/lfs458/">LFS458</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/blog/">blog</a> <a class="post-tag" href="/tags/comments/">comments</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/monitoring/">monitoring</a> <a class="post-tag" href="/tags/system/">system</a> <a class="post-tag" href="/tags/utterances/">utterances</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://ps2046.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-158837927-2"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-158837927-2'); }); </script>
